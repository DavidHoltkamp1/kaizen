<%#This is the start of the question section %>
<div class="row mb-3">
  <div class="col-md-8 themed-grid-col question"><%= @question.subject %> :: <%= @question.upvotes %>
    <% if current_user.nil? %>
      :: <%= image_tag 'upvote.png' %>
    <% elsif current_user.upvoted?(@question) || current_user.id == @question.user_id %>
      :: <%= image_tag 'upvote.png' %>
    <% else %>
      :: <%= link_to image_tag('upvote.png', alt: 'Upvote'), question_upvote_path(@question), method: :post %>
    <% end %>
    <% if current_user %>
      <div class='answerQuestionLink'>
        <%= link_to "Answer Question", "/questions/#{@question.id}/answers/new", method: :get %>
      </div>
    <% end %>
  </div>
  <div class="col-sm-2 themed-grid-col sigBox">
  <p><%= @question.user.user_name %> :: 
     <%= @question.user.cohort %></p>
     <p>Level: </p>
     <p>Awards: </p>
  </div>
</div>

<div class='row mb-3'>
  <% if current_user && current_user.id == @question.user.id %>
    <div class="col-md-8 themed-grid-col"></div>
    <div class="col-sm-2 themed-grid-col questionModification" id='question-crud-<%= @question.id %>'>
      <%= link_to 'Update Question', "/questions/#{@question.id}/edit", method: :get %> :: 
      <%= link_to 'Delete Question', "/questions/#{@question.id}", method: :delete, data: {confirm: "Are you sure?"} %>
    </div>
  <% end %>
</div>

<div class='row mb-3'>
  <div class="col-lg-10 questionBox"><%= @question.content %></div>
</div>

<% if current_user %>
  <div class="row mb-3">
    <div class="col-md-8 themed-grid-col"></div>
    <div class='col-sm-2 themed-grid-col leave-comment'>
      <%= link_to "Leave a Comment", "/questions/#{@question.id}/comments/new" %>
    </div>
  </div>
<% end %>

<%#This is the start of the question comment section %>
<% @question_comments.each do |question_comment| %>
  <section id='question-comment-<%= question_comment.id %>'>
    <div class="row mb-3 commentTextBox">
      <div class='col-sm-1 themed-grid-col'></div>
      <div class="col-md-6 themed-grid-col commentBox">
          <%= question_comment.content %>
      </div>

      <div class="col-sm-2 themed-grid-col commSigBox">
        <p><%= question_comment.user.user_name %></p>
        <p>LEVEL :: AWARDS </p>
      </div>
    </div>

    <div class='row mb-3'>
      <div class="col-sm-1 themed-grid-col "></div>
      <div class="col-md-6 themed-grid-col commentModification">
        <% if current_user.nil? %>
          <%= question_comment.upvotes %> ::
        <% elsif current_user.upvoted?(question_comment) || current_user.id == question_comment.user_id %>
          <%= question_comment.upvotes %> ::
        <% else %>
          <%= question_comment.upvotes %> :: <%= link_to 'Upvote', question_comment_upvote_path(question_comment), method: :post %>
        <% end %>

        <% if current_user && current_user.id == question_comment.user_id %>
          <%= link_to "Edit", "/questions/#{@question.id}/comments/#{question_comment.id}/edit"%> ::
          <%= link_to "Delete", "/questions/#{@question.id}/comments/#{question_comment.id}/delete", method: :delete %>
        <% end %>
        
      </div>
      <div class="col-sm-2 themed-grid-col"></div>
    </div>
  </section>
<% end %>

<%# This is the start of the answers section %>
<% @answers.each do |answer| %>
  <div id="answer-<%= answer.id %>">
    <div class="row mb-3 answerSig">
      <div class="col-md-8 themed-grid-col answer">Answer :: <%= answer.upvotes %>
        <% if current_user.nil? %>
          :: <%= image_tag 'upvote.png' %>
        <% elsif current_user.upvoted?(answer) || current_user.id == answer.user_id %>
          :: <%= image_tag 'upvote.png' %>
        <% else %>
          :: <%= link_to image_tag('upvote.png', alt: 'Upvote'), answer_upvote_path(answer), method: :post %>
        <% end %>
      </div>

      <div class="col-sm-2 themed-grid-col sigBox">
        <p><%= answer.user.user_name %> :: 
          <%= answer.user.cohort %></p>
        <p>Level: </p>
        <p>Awards: </p>
      </div>
    </div>

    <div class='row mb-3' id='question-links-<%= answer.id %>'>
      <div class="col-md-8 themed-grid-col"></div>
      <div class="col-sm-2 themed-grid-col questionModification">
        <% if current_user && current_user.id == answer.user_id %>
          <%= link_to "Update Answer", "/questions/#{@question.id}/answers/#{answer.id}/edit" %> ::
          <%= link_to "Delete Answer", "/questions/#{@question.id}/answers/#{answer.id}/delete", method: :delete %>
        <% end %>
      </div>
    </div>

    <div class='row mb-3'>
      <div class="col-lg-10 questionBox"><%= answer.content %></div>
    </div>

    <% if current_user %>
      <div class="row mb-3">
        <div class="col-md-8 themed-grid-col"></div>
        <div class='col-sm-2 themed-grid-col leave-comment'>
          <%= link_to "Leave a Comment", "/questions/#{@question.id}/answers/#{answer.id}/comments/new" %>
        </div>
      </div>
    <% end %>

    <% answer.comments.each do |answer_comment| %>
      <section id='answer-comment-<%= answer_comment.id %>'>
        <div class="row mb-3 commentTextBox">
          <div class='col-sm-1 themed-grid-col'></div>
          <div class="col-md-6 themed-grid-col commentBox">
            <section id='answer_comment-<%= answer_comment.id %>'>
              <%= answer_comment.content %>
            </section>
          </div>
          <div class="col-sm-2 themed-grid-col commSigBox">
            <p><%= answer_comment.user.user_name %></p>
            <p>LEVEL :: AWARDS </p>
          </div>
        </div>

        <div class='row mb-3'>
          <div class="col-sm-1 themed-grid-col "></div>
          <div class="col-md-6 themed-grid-col commentModification">
            <% if current_user.nil? %>
              <%= answer_comment.upvotes %> ::
            <% elsif current_user.upvoted?(answer_comment) || current_user.id == answer_comment.user_id %>
              <%= answer_comment.upvotes %> ::
            <% else %>
              <%= answer_comment.upvotes %> :: <%= link_to 'upvote.png', answer_comment_upvote_path(answer_comment), method: :post %> 
            <% end %>
            
            <% if current_user && current_user.id == answer_comment.user_id %>
              <%= link_to "Edit", "/questions/#{@question.id}/answers/#{answer.id}/comments/#{answer_comment.id}/edit" %> :: 
              <%= link_to "Delete", "/questions/#{@question.id}/answers/#{answer.id}/comments/#{answer_comment.id}/delete", method: :delete %>
            <% end %>
          </div>
          <div class="col-sm-2 themed-grid-col"></div>
        </div>
      </section>
    <% end %>
  </div>
<% end %>

  
